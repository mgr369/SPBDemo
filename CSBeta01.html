<!DOCTYPE html>
<html>
   <meta charset="UTF-8">
   <meta name="keywords" content="">
   <meta name="viewport"
     content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
   <title></title>
<head>
<script type=module src=./IT_notes/map_v1.js></script>

<link rel='stylesheet' type='text/css' href='./IT_notes/map_v1.css' />
</head>
<body>
<div groupv>
    
<span title>Memory Unit</span>
<pre zoom labels="memory.access,memory.allocation"></prev>
<span xsmall>There are several kind of memories...</span>

• Nowadays we use some levels of Memory with the goal of achieve the better
  relationship between velocity and cost in our computer systems.
• Memory architecture is used to provide CPU the information 
  required, transfering it into register's memory. 

  • Register Memory: Smallest and fastest memory.
    It is the smallest and fastest memory, divided in registers,
    communicates directly within the CPU. 
    <!-- earizon: actually it can be considered part of the CPU -->
    The CPU only works with register's data.
    There are several types of registers. 

  • Cache Memory: Second fastest memory. Access to "Main Memory" is slow.
    The Cache memory move from CPU to Main Memory in blocks, and the OS 
    tries to avoid as many slow access read/write to main memory as possible.
    Cache memory serves as buffer between CPU an memory storing frequently 
    used data (and eventually syncrhonizing with main memory).
    There are some levels of Cache Memory, for instance, in ARM architecture:
     · L1 Cache: Very fast, but limited to a few kilobytes.
     · L2 Cache: Slower than L1, but limited to hundreds of kilobytes.
     · L3 Cache: Slower than L2, but with an storage range varying from 
                 0.5 MByts (in mobiles) to 32+MBytes (in server CPUs).

    In multicore CPUs, different concurrent threads can map the same source-code 
    variable to a different register in a different CPU. Control code must 
    be introduced to synchronize registers (and L1/L2/L3 caches) among the 
    different CPUs. for example Java use the keyword 'volatile' to force 
    Cache syncrhonization among different CPUs.

  • Main Memory (Primary Memory): It is known as RAM (Random Access Memory)
    · This memory stores all information needed (operating system, 
      tasks, information for CPU...) in inmediate use (completing a good 
      environment of work).
    · The most commond kind of main memory is DRAM (Dynamic random 
      access memory)
    · When the CPU tries to fetch some data from Cache and such data is not 
      ready a "Cache miss" is triggered and the data copied from Main Memory.
      In linux we can use next command to monitor the ratio of Cache misses 
      per second:
    $º$ perf stat º

    Note: As the CPU-to-Main Memory speed ratio continues to increase and
          as well as the size of  L3 caches, in some contexts Cache memory 
          is considered "Main Memory" and "Main Merory" is considered 
          auxiliar memory. This is the case with real-time video-games, 
          high-performant 
          
  • Auxillary Memory (Magnetic Disks, for instance): Or simple storage.
    Lowest-cost and highest-capacity memory.  It is where data,
    programs and taks are stored for long term or when they won't
    be used inmediatily. 
</pre>

<pre zoom labels="memory.architecture, ,memory.allocation, memory.shared">
<span title>What is Memory Architecture aim?</span>
• Memory architecture has the aim of making the data required by CPU 
  in the lowest levels of memories (Registers, Cache) 

<hr/>
<span title>Strategies</span>
• Anticipate data that will require CPU:
  ·ºLocality Principle:ºmemories references should be agroupated in a 
    small portion of memory direction's space.
    
  ·ºTemporal Locality:º it is possible to reference a memory direction 
    in near future (in loops, variables...) 

  ·ºSpatial Locality:º  near directions might be referenced in near future.

<hr/>
<span title>transfer among memory levels</span>
• There is a unit of transference called BLOCK, and is a transfer of 
  multiple bytes(words or registers) of data.

<hr/>
• Virtual Memory:
  · It is used to redirect more directions than real ones.

</pre>
</div>

<div groupv>
<pre zoom labels="computer.component, computer.clock,memory">
<span title>Computer Hardware Architecture</span>
• According to their purposes, we can find:
  • Supercomputers
  • Servers
  • Laptops and desktops
  • Tablets and cell-phones
  • Embedded ("IoT") systems


<span title>Von Neumann architecture</span>
<!-- earizon: Reference to Touring machine missing.
   all modern architectures (Von Neumann, Hardward, ...) in the 
   end just try to implement the mathematical model of a complete
   Churck-Touring Universal computation machine -->
• computer architecture based on a 1945 description by John von 
  Neumann and others describes the components of an electronic digital 
  computer. It consists of:
 
  ✓ Processing unit
  ✓ Control unit
  ✓ Memory
  ✓ External mass storage
  ✓ Input and output mechanisms

•ºClock rateº:
  · This frequency measures the speed of the cycles in the processor.
  · Its value is determined by the response time of the circuits which 
    processor is made.
  · It can be stated that if you have two exactly processors, the one that
    have a higher clock frequency will process faster.
</pre>

<pre zoom labels="computer.component, computer.program">
<span title>Software/Hardware relationship</span>
• Programs Definition:
  Sequence of machine instructions stored in memory consecutively.

• Software instructions in high level are transcribed to low level 
  (machine code). 
• Programmes developed in high level (as C#, Java...) are transcribed into machine code.
• There is a stage between high level and machine code called assembly language. 
• Programmes in assembly should be more optimized than in high level.

</pre>

<pre zoom labels="computer.component,">
<span title>Moore's law</span>
• Moore's law is the observation that the number of transistors in a 
  dense integrated circuit (IC) doubles about every two years. 
@[https://en.wikipedia.org/wiki/Moore%27s_law]
• Moore's law end?
  It has stopped growing the double of transistors number. Moore's law 
  continues although power dissipated per unit area on the chip grows 
  with the square of the frequency. This could suppose the end of 
  Moore's.
</div>
</div>

<div groupv>
<pre zoom labels="cpu.arcuitecture.risc,cpu.arcuitecture.cisc,_doc_has.comparative,ISA">
<span title>Processor Architecture and Instruction Set (ISA)</span>

• Risc or Cisc desing?
  One of the most important decisions when we are designing a processor is to decide
  what will be its instruction set (Instructions Set Architecture, ISA).
  · RISC: Reduced Instruction Set Computer.
  · CISC: Complex Instruction Set Computer.

  -  Each ISA defines the design of the processor.
  -  Processors with different architectures have different ISA.
  -  Most current processors are based on RISC architectures.

•ºRISC ARCHITECTURE:º
  RISC machines use very simple instructions. Each operation must be
  expressed as a sequence of these few instructions. 
  1. The language is based on a little repertoire of instructions.
  2. The instructions are very simple. The circuitry is simpler than CISC processors.
  3. For any operation several elementary instructions are required.

•ºCISC ARCHITECTURE:º
  CISC machines use very complex instructions which are very
  descriptive and specific.
  1. The language should contain a wide assortment of instructions (one for
  each different circumstance).
  2. They are complex instructions. Then, they take longer to execute.
  3. Few instructions are required for a specific situation.
<hr/>
• Evolution of processors:
• Current processors are based on a RISC core to which they are added
  resources to execute more complex instructions.
• RISC-type current processor example: ARM
</pre>


<span title>Architecture-Based Performance Improvement Techniques</span>
<pre zoom labels="cpu.architecture, cpu.performance">
<span xsmall>Segmentation, superscaling and multicore</span>
• The segmentation and superscalability of processors try
  to improve performance through parallelism in the execution of the
  instructions. These architectures are capable of execute
  simultaneously a set of machine instructions.

• Current processors exploit other levels of parallelism with
  multicore architectures 
</pre>
</div>

<div groupv>
<pre zoom labels="cpu.lenguage,cpu.arm,_doc_has.table,_PM.TODO">
<span title>(ARM) Machine language</span>
• Machine Language is composed by digital binary numbers
• CPU works with words, a natural unit of data composed by bits (1 and 0)
• Computer (vs human) friendly, intended to communicate directly
  with a computer's hardware.

• ARM Assembly Code Features:
  • There are no variables
  • Operands: Registers, immediate, memory words.
  • Very limited operations.
  • There are directives in assembler.
 
• ARM registers:  (16 registers)
  ┌───────────────┬────────────────────────────────────────────────┐
  │ NAME          │  USE                                           │
  ├───────────────┼────────────────────────────────────────────────┤
  │ R0            │  Argument / Return value / Temporary variables.│
  ├───────────────┼────────────────────────────────────────────────┤
  │ R1─R3         │  Argument / Temporary variables.               │
  ├───────────────┼────────────────────────────────────────────────┤
  │ R4─R11        │  Saved variables.                              │
  ├───────────────┼────────────────────────────────────────────────┤
  │ R12           │  Temporary variable.                           │
  ├───────────────┼────────────────────────────────────────────────┤
  │ R13 (SP)      │  Stack Pointer.                                │
  ├───────────────┼────────────────────────────────────────────────┤
  │ R14 (LR)      │  Link Register.                                │
  ├───────────────┼────────────────────────────────────────────────┤
  │ R15 (PC)      │  Program Counter.                              │
  └───────────────┴────────────────────────────────────────────────┘
• ARMV4 instructions set: 
  <!-- TODO: Completar con imágenes. -->

<hr/>
<span xsmall>"Modern" ISA ARM core</span>
• 32-bit address bus
• 32-bit memory words
• 32-bit instructions
• Bank of 16 registers
</pre>

<span title>High-Level Code</span>
<pre zoom labels="cpu.lenguage.high">
<span xsmall>A high-level programming language</span>
High-level code is designed to be read by human programmers.
-Variables and structures are defined.
-Each instruction can be expressed.
with various instructions in assembler.
-Varied syntax.
</pre>

</div>

<div groupv>
<pre zoom labels="cpu.time,cpu.performance,cpu.performance,_doc_has.comparative,">
<span title>Execution time</span>
• It is necessary to differentiate some types of time:
  The time that takes a program to be executed by a computer can be
  difficult to measure, due to Multitasking Operating Systems and
  I/O.    

  * Time elapsed:
      • It counts everything (disk and memory accesses, I/O, etc.)
      • It is what the user perceives, but it is not used for comparisons.
  
  * CPU time:
       • It does not count I/O and the time consumed by other programs.
       • It is divided into system time and user time.
  
  * CPU time used by OS:
       • The time that takes the OS in carrying out its internal management.
  
  * User CPU time:
       • Time spent executing the lines of code that are in our program.
  
  e.g.: On UNIX/Linux we can execute a program and check statistics about 
        time by simply using the 'time' command like: 
               ┌────────┬·····← real command to be executed.
     $º $ time find /home  º  ← 'time' gathers execution stats.
     $º ...                º 
     $º real    0m10.402s  º  ← Example output
     $º user    0m0.827s   º   
     $º sys     0m2.133s   º


<span title>What is performance?</span>
• Comparing performance of various processors:
  From an architectural point of view, when comparing performance
  of various processors this is measured as:
  · Performance = 1 / X ; where X is user CPU time.

   Program execution time = CPU time + I/O wait.

• IRON LAW: Expression of the performance of a CPU
  CPU time = (Instructions/program) * CPI * (Time/Cycle)
                                      └┬┘    └───┬────┘
                          Cycles/instruction  Inverse of CPU-frequency

• MIPS: (M)illions of (I)nstructions (P)er (S)econd:
  MIPS = Instructions / (CPU time * 10^6)
  · Frequently used unit to measure the performance of a CPU.
  · A CPU with higher MIPS and slower CPU clock is faster than a 
    a CPU with lower  MIPS and higher CPU clock.

• FLOPS: (FL)oating-point (OP)erations (P)er (S)econd:
  FLOPS = Floating Poins Instructions / (CPU time * 10^6)
  · Frequently used unit to measure the performance of a CPU in 
    calculations requiring heavy use of floating point operations.

• ENERGY EFFICIENCY:
  Reducing energy consumption has become an objective in the
  design of modern processors.
  ENERGY EFFICIENCY = GFLOPs / watt ; Watt: Unit of energy-power
                                            (Jules-of-energy spent per second)
</pre>
</div>
    
</div>
</body>
</html>
<!-- 
_PM. prefix: stands for project management. 
  _PM.TODO: tasks in state TO-be-DOne.
  _PM.WiP : tasks in state WiP.
  _PM.backlog: tasks planned for future sprints , ...

Hardward vs VonNeumann Architecture:
@[https://en.wikipedia.org/wiki/Harvard_architecture]
vs
@[https://en.wikipedia.org/wiki/Von_Neumann_architecture]
##################################################################
<span xsmall>CPU in Javascript</span>
https://www.neoteo.com/nand-game-construye-un-cpu-en-tu-navegador/
##################################################################
<span xsmall>Modern CPUs design</span>
REF: http://www.lighterra.com/papers/modernmicroprocessors/
##################################################################
<span xsmall>How do CPUs read machine code:</span>
@[https://www.youtube.com/watch?v=yl8vPW5hydQ]
##################################################################
Real RAM CPU Frequency:
https://hardzone.es/tutoriales/rendimiento/frecuencia-real-memoria-ram-ddr4/
Frecuencia real de la memoria RAM: ¿qué es y cómo se calcula?
https://hardzone.es/reportajes/comparativas/latencia-velocidad-ram-jugar/
¿Qué influye más en la memoria RAM para jugar, la frecuencia o la latencia?
#################
Emulating a CPU in C++
https://www.youtube.com/watch?v=qJgsuQoy9bc
#####################
Comp theory: 8086 microcode disassembled « Reenigne blog
https://www.reenigne.org/blog/8086-microcode-disassembled/ 
########################
Jim Keller: "Si quisiera fabricar un PC a día de hoy, escogería RISC-V"
https://elchapuzasinformatico.com/2021/09/jim-keller-si-quisiera-fabricar-un-pc-a-dia-de-hoy-escogeria-risc-v/ 
-->
